import{E as M,r as m,aj as E,B as j,d as g,l as P,i as U,o as x,u as o,w as a,a as y,b as e,s as H,C as c,t as C,P as J,v as R,aa as v,ag as K,ah as O}from"./index-BFQrjWEt.js";import{u as S}from"./userService-CPabbIoI.js";import{a as T}from"./avatar-1-X5zaJOKz.js";import{V as Q}from"./VDataTable-DZpwKLM7.js";import{V as B}from"./VAvatar-DUOVUhk-.js";import{V as w}from"./VImg-CeY41Y31.js";import{u as W}from"./useApi-D0WnRYov.js";import{V as X}from"./VAutocomplete-Bv9DTkuc.js";import{b as Y}from"./VMenu-C5BeancQ.js";import{V as Z}from"./VDialog-auUX6v2p.js";import{V as F,c as I,a as N,b as k,d as q}from"./VCard-Bo8UnrY0.js";import{V as ee}from"./VForm-GGcZgMQV.js";import{V as L,a as _}from"./VRow-y4cLhuu7.js";import{V as b}from"./VTextField-DSt3uY9J.js";import{V as z}from"./VDivider-C2eX1P_t.js";import{V as ae}from"./VSpacer-DFPYcyEY.js";import"./index-xsH4HHeE.js";import"./VSelect-BJnTqPQw.js";import"./index-1Jrqu1Jx.js";import"./VSlideGroup-b9wzHkwm.js";import"./VTable-BvWckMNL.js";import"./ssrBoot-DO_4U4Hx.js";/* empty css              */const G=M("user",()=>{const p=m(),l=m(!1),d=m(),u=E();async function f(){var i,r;try{l.value=!0,p.value=await S.getUsers()}catch(s){console.error(s),u.show(((r=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:r.message)||"fetch user error.")}finally{l.value=!1}}const n=j(()=>p.value?p.value.reduce((i,r)=>(i[r.id]=r,i),{}):{});return{users:p,loading:l,message:d,fetch:f,usersMap:n}}),se={class:"d-flex align-center"},te={class:"d-flex flex-column"},re={class:"text-sm text-medium-emphasis"},le=g({__name:"UserDataTable",props:{users:Array},setup(p){const l=m([{title:"ID",key:"id"},{title:"User",key:"username"},{title:"Email",key:"email"},{title:"Login Failed Attempts",key:"loginFailedAttempts"},{title:"Last Login Date",key:"LastLoginDate"},{title:"Role",key:"roles"}]),d=G(),u=void 0;return P(async()=>{await d.fetch()}),(f,n)=>{const i=H("RouterLink");return x(),U(Q,{headers:o(l),items:o(d).users},{"item.id":a(({item:r})=>[e(i,{to:`/users/${r.username}`,class:"text-blue text-decoration-none"},{default:a(()=>[c(" #"+C(r.id),1)]),_:2},1032,["to"])]),"item.username":a(({item:r})=>[y("div",se,[e(B,{size:"34",class:"me-3"},{default:a(()=>[e(w,{src:`${o(u)}/api/v1/users/${r.id}/image`},{error:a(()=>[e(w,{src:o(T)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024),y("div",te,[e(i,{to:`/users/${r.username}`,class:"text-h6 font-weight-medium user-list-name"},{default:a(()=>[c(C(r.username),1)]),_:2},1032,["to"]),y("span",re,C(r.email),1)])])]),_:1},8,["headers","items"])}}}),oe=g({__name:"UserDropdown",setup(p){const l=m(""),{data:d,loading:u,fetch:f}=W(),n=void 0,i=(r,s,t)=>{var h,$,D,A;if(!s)return!0;const V=s.toLowerCase();return(($=(h=t.raw)==null?void 0:h.username)==null?void 0:$.toLowerCase().includes(V))||((A=(D=t.raw)==null?void 0:D.email)==null?void 0:A.toLowerCase().includes(V))};return P(async()=>{await f(S.getUsers())}),(r,s)=>(x(),U(X,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=t=>l.value=t),items:o(d),loading:o(u),"item-value":"id","item-title":"username",label:"Search","custom-filter":i},{item:a(({props:t,item:V})=>[e(Y,J(t,{title:V.raw.username,subtitle:V.raw.email}),{prepend:a(()=>[e(B,null,{default:a(()=>[e(w,{src:`${o(n)}/api/v1/users/${V.value}/image`},{error:a(()=>[e(w,{src:o(T)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024)]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","items","loading"]))}}),ue=g({__name:"AddUser",setup(p){const l=m(!1),d=m(!1),u=E(),f=G(),n=m({username:"",email:"",password:""}),i=async()=>{var r,s;try{d.value=!0,await S.createUser(n.value),u.show("User created successfully!","success"),await f.fetch(),l.value=!1}catch(t){console.error(t),u.show(((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||t.message)}finally{d.value=!1}};return(r,s)=>(x(),U(Z,{modelValue:o(l),"onUpdate:modelValue":s[4]||(s[4]=t=>R(l)?l.value=t:null),"max-width":"600px",persistent:""},{activator:a(({props:t})=>[e(v,K(O(t)),{default:a(()=>s[5]||(s[5]=[c(" Create User ")])),_:2},1040)]),default:a(()=>[e(F,null,{default:a(()=>[e(I,null,{default:a(()=>[e(N,null,{default:a(()=>s[6]||(s[6]=[c("Create User")])),_:1})]),_:1}),e(k,null,{default:a(()=>[e(ee,null,{default:a(()=>[e(L,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(b,{modelValue:o(n).username,"onUpdate:modelValue":s[0]||(s[0]=t=>o(n).username=t),label:"Username",placeholder:"Enter username"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:a(()=>[e(b,{modelValue:o(n).email,"onUpdate:modelValue":s[1]||(s[1]=t=>o(n).email=t),label:"Email",placeholder:"Enter email"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:a(()=>[e(b,{modelValue:o(n).password,"onUpdate:modelValue":s[2]||(s[2]=t=>o(n).password=t),label:"Password",placeholder:"Enter password",type:"password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(z),e(q,{class:"pa-2"},{default:a(()=>[e(v,{color:"error",onClick:s[3]||(s[3]=t=>l.value=!1)},{default:a(()=>s[7]||(s[7]=[c(" Cancel ")])),_:1}),e(v,{color:"primary",variant:"elevated",onClick:i},{default:a(()=>s[8]||(s[8]=[c(" Create ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ae=g({__name:"UserListPage",setup(p){const l=m();return(d,u)=>(x(),U(L,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(F,null,{default:a(()=>[e(I,null,{default:a(()=>[e(N,null,{default:a(()=>u[1]||(u[1]=[c("User List")])),_:1})]),_:1}),e(k,null,{default:a(()=>[e(L,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(oe,{modelValue:o(l),"onUpdate:modelValue":u[0]||(u[0]=f=>R(l)?l.value=f:null)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(z),e(k,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[e(ae),e(v,null,{default:a(()=>u[2]||(u[2]=[c("Search")])),_:1}),e(ue)]),_:1}),e(le)]),_:1})]),_:1})]),_:1}))}});export{Ae as default};
