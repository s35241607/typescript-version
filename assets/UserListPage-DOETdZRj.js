import{C as M,r as c,ag as L,y as j,d as w,i as T,f as y,o as U,u as n,w as s,a as x,b as a,m as H,A as p,t as C,N as J,p as E,a6 as v,ad as K,ae as O}from"./index-MR7RJxXF.js";import{u as h}from"./userService-BujVmlIT.js";import{a as P}from"./avatar-1-X5zaJOKz.js";import{a as Q}from"./VDataTable-C6r_LZmz.js";import{V as B}from"./VAvatar-ankHx5PL.js";import{V as g}from"./VImg-C2sqcCEo.js";import{V as W}from"./VAutocomplete-Lf0hwgOA.js";import{b as X}from"./VMenu-B7aNBrm2.js";import{V as Y}from"./VDialog-BXHo_uzr.js";import{V as F,b as I,c as N,a as k,d as Z}from"./VCard-D-8VKy4F.js";import{V as q}from"./VForm-D6U5qb7f.js";import{a as S,V as _}from"./VRow-Bq0pyKsC.js";import{V as b}from"./VTextField-B6hsOAc7.js";import{V as z}from"./VDivider-DIljL8wY.js";import{V as ee}from"./VSpacer-CKXvxEre.js";import"./index-D8rVyQy1.js";import"./index-DSS_s2C3.js";import"./VSlideGroup-CJhjP-yV.js";import"./VTable-CoiNOvUb.js";import"./ssrBoot-uBtU7MA7.js";/* empty css              */const G=M("user",()=>{const m=c(),l=c(!1),d=c(),o=L();async function f(){var i,r;try{l.value=!0,m.value=await h.getUsers()}catch(e){console.error(e),o.show(((r=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:r.message)||"fetch user error.")}finally{l.value=!1}}const u=j(()=>m.value?m.value.reduce((i,r)=>(i[r.id]=r,i),{}):{});return{users:m,loading:l,message:d,fetch:f,usersMap:u}}),ae={class:"d-flex align-center"},se={class:"d-flex flex-column"},te={class:"text-sm text-medium-emphasis"},le=w({__name:"UserDataTable",props:{users:Array},setup(m){const l=c([{title:"ID",key:"id"},{title:"User",key:"username"},{title:"Email",key:"email"},{title:"Login Failed Attempts",key:"loginFailedAttempts"},{title:"Last Login Date",key:"LastLoginDate"},{title:"Role",key:"roles"}]),d=G(),o=void 0;return T(async()=>{await d.fetch()}),(f,u)=>{const i=H("RouterLink");return U(),y(Q,{headers:n(l),items:n(d).users},{"item.id":s(({item:r})=>[a(i,{to:`/users/${r.username}`,class:"text-blue text-decoration-none"},{default:s(()=>[p(" #"+C(r.id),1)]),_:2},1032,["to"])]),"item.username":s(({item:r})=>[x("div",ae,[a(B,{size:"34",class:"me-3"},{default:s(()=>[a(g,{src:`${n(o)}/api/v1/users/${r.id}/image`},{error:s(()=>[a(g,{src:n(P)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024),x("div",se,[a(i,{to:`/users/${r.username}`,class:"text-h6 font-weight-medium user-list-name"},{default:s(()=>[p(C(r.username),1)]),_:2},1032,["to"]),x("span",te,C(r.email),1)])])]),_:1},8,["headers","items"])}}});function re(){const m=c(),l=c(!1),d=L();async function o(f,u=null){var i,r;try{l.value=!0;const e=await f;m.value=u?e.map(u):e}catch(e){console.error(e),d.show(((r=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:r.message)||(e==null?void 0:e.message))}finally{l.value=!1}}return{data:m,loading:l,fetch:o}}const oe=w({__name:"UserDropdown",setup(m){const l=c(""),{data:d,loading:o,fetch:f}=re(),u=void 0,i=(r,e,t)=>{var $,A,D,R;if(!e)return!0;const V=e.toLowerCase();return((A=($=t.raw)==null?void 0:$.username)==null?void 0:A.toLowerCase().includes(V))||((R=(D=t.raw)==null?void 0:D.email)==null?void 0:R.toLowerCase().includes(V))};return T(async()=>{await f(h.getUsers())}),(r,e)=>(U(),y(W,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),items:n(d),loading:n(o),"item-value":"id","item-title":"username",label:"Search","custom-filter":i},{item:s(({props:t,item:V})=>[a(X,J(t,{title:V.raw.username,subtitle:V.raw.email}),{prepend:s(()=>[a(B,null,{default:s(()=>[a(g,{src:`${n(u)}/api/v1/users/${V.value}/image`},{error:s(()=>[a(g,{src:n(P)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024)]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","items","loading"]))}}),ne=w({__name:"AddUser",setup(m){const l=c(!1),d=c(!1),o=L(),f=G(),u=c({username:"",email:"",password:""}),i=async()=>{var r,e;try{d.value=!0,await h.createUser(u.value),o.show("User created successfully!","success"),await f.fetch(),l.value=!1}catch(t){console.error(t),o.show(((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||t.message)}finally{d.value=!1}};return(r,e)=>(U(),y(Y,{modelValue:n(l),"onUpdate:modelValue":e[4]||(e[4]=t=>E(l)?l.value=t:null),"max-width":"600px",persistent:""},{activator:s(({props:t})=>[a(v,K(O(t)),{default:s(()=>e[5]||(e[5]=[p(" Create User ")])),_:2},1040)]),default:s(()=>[a(F,null,{default:s(()=>[a(I,null,{default:s(()=>[a(N,null,{default:s(()=>e[6]||(e[6]=[p("Create User")])),_:1})]),_:1}),a(k,null,{default:s(()=>[a(q,null,{default:s(()=>[a(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).username,"onUpdate:modelValue":e[0]||(e[0]=t=>n(u).username=t),label:"Username",placeholder:"Enter username"},null,8,["modelValue"])]),_:1}),a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).email,"onUpdate:modelValue":e[1]||(e[1]=t=>n(u).email=t),label:"Email",placeholder:"Enter email"},null,8,["modelValue"])]),_:1}),a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).password,"onUpdate:modelValue":e[2]||(e[2]=t=>n(u).password=t),label:"Password",placeholder:"Enter password",type:"password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(z),a(Z,{class:"pa-2"},{default:s(()=>[a(v,{color:"error",onClick:e[3]||(e[3]=t=>l.value=!1)},{default:s(()=>e[7]||(e[7]=[p(" Cancel ")])),_:1}),a(v,{color:"primary",variant:"elevated",onClick:i},{default:s(()=>e[8]||(e[8]=[p(" Create ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),$e=w({__name:"UserListPage",setup(m){const l=c();return(d,o)=>(U(),y(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(F,null,{default:s(()=>[a(I,null,{default:s(()=>[a(N,null,{default:s(()=>o[1]||(o[1]=[p("User List")])),_:1})]),_:1}),a(k,null,{default:s(()=>[a(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(oe,{modelValue:n(l),"onUpdate:modelValue":o[0]||(o[0]=f=>E(l)?l.value=f:null)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(z),a(k,{class:"d-flex flex-wrap gap-4"},{default:s(()=>[a(ee),a(v,null,{default:s(()=>o[2]||(o[2]=[p("Search")])),_:1}),a(ne)]),_:1}),a(le)]),_:1})]),_:1})]),_:1}))}});export{$e as default};
