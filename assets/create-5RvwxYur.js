import{d as Y,ah as Z,r as T,ak as ee,A as le,i as C,o as p,w as l,aj as ae,b as e,a as d,aa as S,y as r,V as u,ag as te,Q as f,t as s,C as L,D as M,c as B,f as P,_ as ie}from"./index-BkP98Z5W.js";import{Q as oe}from"./QuillEditor-CIwuU6C4.js";import{V as ne}from"./VContainer-B-o8UyLl.js";import{a as m,V as c}from"./VRow-BpTHjCfe.js";import{V as b,a as v,b as g}from"./VCard-Cactyszq.js";import{V as re}from"./VForm-OwsrPP-6.js";import{V as se,a as de}from"./VTextField-C9fUFT2t.js";import{a as V,V as U}from"./VSelect-BZ0Y1qL-.js";import{b as y,c as _,d as z}from"./VList-CVAT_jEk.js";import{V as R}from"./VAutocomplete-BME38EMO.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VAvatar-S20edQv8.js";import"./VImg-eWa6LTGm.js";/* empty css              */import"./index-BLjbFAm_.js";import"./VMenu-DrivdkYd.js";import"./VSlideGroup-CVLn1jny.js";import"./ssrBoot-CwC5mDKq.js";import"./VDivider-CzYsyaHo.js";import"./filter-O0tjLM2q.js";const me={class:"d-flex align-center justify-space-between mb-6"},ue={class:"d-flex gap-3"},ce={class:"preview-content"},pe={class:"text-subtitle-1 font-weight-bold mb-2"},fe={class:"d-flex gap-2 mb-3"},be=["innerHTML"],ve={key:1,class:"text-medium-emphasis"},ge=Y({name:"CreateTicketPage",__name:"create",setup(Ve){const w=ae(),x=Z(),I=T(),k=T(!1),h=T(!1),o=ee({title:"",description:"",priority:"medium",type:"task",assignees:[],labels:[],milestone:null}),J=[i=>!!i||"標題為必填項目",i=>i.length>=3||"標題至少需要 3 個字元",i=>i.length<=100||"標題不能超過 100 個字元"],j=[{label:"低",value:"low",icon:"ri-arrow-down-line",color:"success"},{label:"中",value:"medium",icon:"ri-subtract-line",color:"warning"},{label:"高",value:"high",icon:"ri-arrow-up-line",color:"error"},{label:"緊急",value:"critical",icon:"ri-alarm-warning-line",color:"error"}],D=[{label:"任務",value:"task",icon:"ri-task-line"},{label:"錯誤",value:"bug",icon:"ri-bug-line"},{label:"功能",value:"feature",icon:"ri-lightbulb-line"},{label:"改進",value:"enhancement",icon:"ri-rocket-line"},{label:"文件",value:"documentation",icon:"ri-file-text-line"}],F=[{id:1,name:"John Doe",email:"john@example.com",avatar:"https://cdn.vuetifyjs.com/images/john.jpg"},{id:2,name:"Jane Smith",email:"jane@example.com",avatar:"https://cdn.vuetifyjs.com/images/jane.jpg"},{id:3,name:"Mike Johnson",email:"mike@example.com",avatar:"https://cdn.vuetifyjs.com/images/mike.jpg"},{id:4,name:"王小明",email:"wang@example.com",avatar:""},{id:5,name:"李小華",email:"li@example.com",avatar:""}],N=[{id:1,name:"John Doe",email:"john@example.com",avatar:"https://cdn.vuetifyjs.com/images/john.jpg"},{id:2,name:"Jane Smith",email:"jane@example.com",avatar:"https://cdn.vuetifyjs.com/images/jane.jpg"},{id:3,name:"Mike Johnson",email:"mike@example.com",avatar:"https://cdn.vuetifyjs.com/images/mike.jpg"},{id:4,name:"王小明",email:"wang@example.com",avatar:""},{id:5,name:"李小華",email:"li@example.com",avatar:""},{id:6,name:"張三",email:"zhang@example.com",avatar:""},{id:7,name:"李四",email:"li4@example.com",avatar:""}],E=[{id:1,name:"Frontend",description:"前端相關",color:"primary"},{id:2,name:"Backend",description:"後端相關",color:"secondary"},{id:3,name:"UI/UX",description:"使用者介面設計",color:"info"},{id:4,name:"Critical",description:"重要問題",color:"error"},{id:5,name:"Enhancement",description:"功能增強",color:"success"}],H=[{id:1,title:"Version 1.0",dueDate:"2024-12-31"},{id:2,title:"Sprint 1",dueDate:"2024-11-15"},{id:3,title:"Beta Release",dueDate:"2024-10-30"}],Q=le(()=>o.title.trim()!==""||o.description.trim()!==""),$=i=>{const a=j.find(t=>t.value===i);return(a==null?void 0:a.color)||"primary"},A=i=>{const a=j.find(t=>t.value===i);return(a==null?void 0:a.label)||i},O=i=>{const a=D.find(t=>t.value===i);return(a==null?void 0:a.label)||i},q=i=>new Date(i).toLocaleDateString("zh-TW"),W=i=>i.replace(/<script[^>]*>.*?<\/script>/gi,""),X=i=>{console.log("提及用戶:",i),x.show(`提及了 ${i.name}`,"info")},G=async()=>{if(k.value)try{h.value=!0,await new Promise(i=>setTimeout(i,1500)),console.log("建立 Ticket:",o),x.show("Ticket 建立成功！","success"),w.push("/tickets")}catch(i){console.error("建立 Ticket 失敗:",i),x.show("建立 Ticket 失敗，請稍後再試","error")}finally{h.value=!1}},K=()=>{Q.value?confirm("您有未儲存的變更，確定要離開嗎？")&&w.back():w.back()};return(i,a)=>(p(),C(ne,{fluid:"",class:"create-ticket-page"},{default:l(()=>[e(c,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[d("div",me,[a[10]||(a[10]=d("div",null,[d("h1",{class:"text-h4 font-weight-bold mb-2"}," 建立新 Ticket "),d("p",{class:"text-body-1 text-medium-emphasis"}," 填寫詳細資訊來建立一個新的 Ticket ")],-1)),e(S,{variant:"text",color:"primary","prepend-icon":"ri-arrow-left-line",onClick:a[0]||(a[0]=t=>i.$router.back())},{default:l(()=>[...a[9]||(a[9]=[r(" 返回 ",-1)])]),_:1})])]),_:1})]),_:1}),e(c,null,{default:l(()=>[e(m,{cols:"12",lg:"8"},{default:l(()=>[e(b,{class:"mb-6"},{default:l(()=>[e(v,{class:"d-flex align-center"},{default:l(()=>[e(u,{icon:"ri-ticket-line",class:"me-2"}),a[11]||(a[11]=r(" Ticket 資訊 ",-1))]),_:1}),e(g,null,{default:l(()=>[e(re,{ref_key:"formRef",ref:I,modelValue:k.value,"onUpdate:modelValue":a[5]||(a[5]=t=>k.value=t),onSubmit:te(G,["prevent"])},{default:l(()=>[e(c,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(se,{modelValue:o.title,"onUpdate:modelValue":a[1]||(a[1]=t=>o.title=t),label:"標題",placeholder:"請輸入 Ticket 標題...",variant:"outlined",density:"comfortable",rules:J,"prepend-inner-icon":"ri-text",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(c,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(de,{class:"text-body-2 font-weight-medium mb-2"},{default:l(()=>[a[13]||(a[13]=r(" 內容描述 * ",-1)),e(V,{size:"x-small",color:"info",variant:"tonal",class:"ml-2"},{default:l(()=>[...a[12]||(a[12]=[r(" 支援 @mention ",-1)])]),_:1})]),_:1}),e(oe,{modelValue:o.description,"onUpdate:modelValue":a[2]||(a[2]=t=>o.description=t),height:300,"mention-users":N,"enable-mention":!0,placeholder:"請輸入工單內容... 輸入 @ 可以提及其他用戶",class:"mb-4",onMention:X},null,8,["modelValue"])]),_:1})]),_:1}),e(c,null,{default:l(()=>[e(m,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:o.priority,"onUpdate:modelValue":a[3]||(a[3]=t=>o.priority=t),label:"優先級",items:j,"item-title":"label","item-value":"value",variant:"outlined",density:"comfortable","prepend-inner-icon":"ri-flag-line"},{item:l(({props:t,item:n})=>[e(y,f(t,{"prepend-icon":n.raw.icon}),{default:l(()=>[e(_,null,{default:l(()=>[r(s(n.raw.label),1)]),_:2},1024)]),_:2},1040,["prepend-icon"])]),_:1},8,["modelValue"])]),_:1}),e(m,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:o.type,"onUpdate:modelValue":a[4]||(a[4]=t=>o.type=t),label:"類型",items:D,"item-title":"label","item-value":"value",variant:"outlined",density:"comfortable","prepend-inner-icon":"ri-apps-line"},{item:l(({props:t,item:n})=>[e(y,f(t,{"prepend-icon":n.raw.icon}),{default:l(()=>[e(_,null,{default:l(()=>[r(s(n.raw.label),1)]),_:2},1024)]),_:2},1040,["prepend-icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(c,{class:"mt-4"},{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[d("div",ue,[e(S,{type:"submit",color:"primary",variant:"flat",size:"large","prepend-icon":"ri-add-line",loading:h.value,disabled:!k.value},{default:l(()=>[...a[14]||(a[14]=[r(" 建立 Ticket ",-1)])]),_:1},8,["loading","disabled"]),e(S,{variant:"outlined",size:"large",onClick:K},{default:l(()=>[...a[15]||(a[15]=[r(" 取消 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",lg:"4"},{default:l(()=>[e(b,{class:"mb-4"},{default:l(()=>[e(v,{class:"d-flex align-center"},{default:l(()=>[e(u,{icon:"ri-user-line",class:"me-2"}),a[16]||(a[16]=r(" 指派人員 ",-1))]),_:1}),e(g,null,{default:l(()=>[e(R,{modelValue:o.assignees,"onUpdate:modelValue":a[6]||(a[6]=t=>o.assignees=t),label:"選擇指派人員",items:F,"item-title":"name","item-value":"id",variant:"outlined",density:"comfortable",multiple:"",chips:"","closable-chips":"","prepend-inner-icon":"ri-user-search-line","no-data-text":"沒有找到使用者"},{chip:l(({props:t,item:n})=>[e(V,f(t,{"prepend-avatar":n.raw.avatar,size:"small"}),{default:l(()=>[r(s(n.raw.name),1)]),_:2},1040,["prepend-avatar"])]),item:l(({props:t,item:n})=>[e(y,f(t,{"prepend-avatar":n.raw.avatar}),{default:l(()=>[e(_,null,{default:l(()=>[r(s(n.raw.name),1)]),_:2},1024),e(z,null,{default:l(()=>[r(s(n.raw.email),1)]),_:2},1024)]),_:2},1040,["prepend-avatar"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,{class:"mb-4"},{default:l(()=>[e(v,{class:"d-flex align-center"},{default:l(()=>[e(u,{icon:"ri-price-tag-3-line",class:"me-2"}),a[17]||(a[17]=r(" 標籤 ",-1))]),_:1}),e(g,null,{default:l(()=>[e(R,{modelValue:o.labels,"onUpdate:modelValue":a[7]||(a[7]=t=>o.labels=t),label:"選擇標籤",items:E,"item-title":"name","item-value":"id",variant:"outlined",density:"comfortable",multiple:"",chips:"","closable-chips":"","prepend-inner-icon":"ri-hashtag","no-data-text":"沒有找到標籤"},{chip:l(({props:t,item:n})=>[e(V,f(t,{color:n.raw.color,size:"small"}),{default:l(()=>[r(s(n.raw.name),1)]),_:2},1040,["color"])]),item:l(({props:t,item:n})=>[e(y,L(M(t)),{prepend:l(()=>[e(u,{color:n.raw.color,icon:"ri-circle-fill",size:"small"},null,8,["color"])]),default:l(()=>[e(_,null,{default:l(()=>[r(s(n.raw.name),1)]),_:2},1024),e(z,null,{default:l(()=>[r(s(n.raw.description),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,{class:"mb-4"},{default:l(()=>[e(v,{class:"d-flex align-center"},{default:l(()=>[e(u,{icon:"ri-milestone-line",class:"me-2"}),a[18]||(a[18]=r(" 里程碑 ",-1))]),_:1}),e(g,null,{default:l(()=>[e(U,{modelValue:o.milestone,"onUpdate:modelValue":a[8]||(a[8]=t=>o.milestone=t),label:"選擇里程碑",items:H,"item-title":"title","item-value":"id",variant:"outlined",density:"comfortable","prepend-inner-icon":"ri-flag-2-line",clearable:""},{item:l(({props:t,item:n})=>[e(y,L(M(t)),{default:l(()=>[e(_,null,{default:l(()=>[r(s(n.raw.title),1)]),_:2},1024),e(z,null,{default:l(()=>[r(" 截止日期: "+s(q(n.raw.dueDate)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(v,{class:"d-flex align-center"},{default:l(()=>[e(u,{icon:"ri-eye-line",class:"me-2"}),a[19]||(a[19]=r(" 預覽 ",-1))]),_:1}),e(g,null,{default:l(()=>[d("div",ce,[d("h3",pe,s(o.title||"標題預覽"),1),d("div",fe,[o.priority?(p(),C(V,{key:0,color:$(o.priority),size:"small"},{default:l(()=>[r(s(A(o.priority)),1)]),_:1},8,["color"])):P("",!0),o.type?(p(),C(V,{key:1,color:"info",size:"small"},{default:l(()=>[r(s(O(o.type)),1)]),_:1})):P("",!0)]),o.description?(p(),B("div",{key:0,class:"preview-description",innerHTML:W(o.description)},null,8,be)):(p(),B("div",ve," 內容描述將顯示在這裡... "))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Fe=ie(ge,[["__scopeId","data-v-13070b8b"]]);export{Fe as default};
