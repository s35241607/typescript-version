import{C as M,r as c,ag as L,y as Y,d as w,i as T,m as j,o as y,f as U,w as s,b as a,A as f,t as x,a as C,u as n,Y as H,ad as J,ae as K,a6 as v,p as E}from"./index-zKhGRW4j.js";import{u as h}from"./userService-BW7GOPuY.js";import{a as P}from"./avatar-1-X5zaJOKz.js";import{V as g}from"./VImg-D_4lKa9k.js";import{V as B}from"./VAvatar-Cmp1HVpv.js";import{a as O}from"./VDataTable-CgZpxlwx.js";import{b as Q}from"./VMenu-CihhXAQB.js";import{V as W}from"./VAutocomplete-Y_vvU0Bg.js";import{b as F,c as I,V as k,d as X,a as N}from"./VCard-B9U4dV_-.js";import{V as Z}from"./VForm-BJyz97b7.js";import{a as S,V as _}from"./VRow-C8ZupI-J.js";import{V as b}from"./VTextField-D5M6AepD.js";import{V as z}from"./VDivider-CWK93Qol.js";import{V as q}from"./VDialog-C-PEh28p.js";import{V as ee}from"./VSpacer-mXhhmL5s.js";import"./axios-upsvKRUO.js";import"./dialog-transition-Cbt88Fex.js";import"./index-DXtOtbdz.js";import"./VSlideGroup-frBfTOQL.js";import"./VTable-U4Rhi-JS.js";import"./ssrBoot-DE5jnKlR.js";/* empty css              */const G=M("user",()=>{const m=c(),l=c(!1),d=c(),o=L();async function p(){var i,r;try{l.value=!0,m.value=await h.getUsers()}catch(e){console.error(e),o.show(((r=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:r.message)||"fetch user error.")}finally{l.value=!1}}const u=Y(()=>m.value?m.value.reduce((i,r)=>(i[r.id]=r,i),{}):{});return{users:m,loading:l,message:d,fetch:p,usersMap:u}}),ae={class:"d-flex align-center"},se={class:"d-flex flex-column"},te={class:"text-sm text-medium-emphasis"},le=w({__name:"UserDataTable",props:{users:Array},setup(m){const l=c([{title:"ID",key:"id"},{title:"User",key:"username"},{title:"Email",key:"email"},{title:"Login Failed Attempts",key:"loginFailedAttempts"},{title:"Last Login Date",key:"LastLoginDate"},{title:"Role",key:"roles"}]),d=G(),o=void 0;return T(async()=>{await d.fetch()}),(p,u)=>{const i=j("RouterLink");return y(),U(O,{headers:n(l),items:n(d).users},{"item.id":s(({item:r})=>[a(i,{to:`/users/${r.username}`,class:"text-blue text-decoration-none"},{default:s(()=>[f(" #"+x(r.id),1)]),_:2},1032,["to"])]),"item.username":s(({item:r})=>[C("div",ae,[a(B,{size:"34",class:"me-3"},{default:s(()=>[a(g,{src:`${n(o)}/api/v1/users/${r.id}/image`},{error:s(()=>[a(g,{src:n(P)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024),C("div",se,[a(i,{to:`/users/${r.username}`,class:"text-h6 font-weight-medium user-list-name"},{default:s(()=>[f(x(r.username),1)]),_:2},1032,["to"]),C("span",te,x(r.email),1)])])]),_:1},8,["headers","items"])}}});function re(){const m=c(),l=c(!1),d=L();async function o(p,u=null){var i,r;try{l.value=!0;const e=await p;m.value=u?e.map(u):e}catch(e){console.error(e),d.show(((r=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:r.message)||(e==null?void 0:e.message))}finally{l.value=!1}}return{data:m,loading:l,fetch:o}}const oe=w({__name:"UserDropdown",setup(m){const l=c(""),{data:d,loading:o,fetch:p}=re(),u=void 0,i=(r,e,t)=>{var $,A,D,R;if(!e)return!0;const V=e.toLowerCase();return((A=($=t.raw)==null?void 0:$.username)==null?void 0:A.toLowerCase().includes(V))||((R=(D=t.raw)==null?void 0:D.email)==null?void 0:R.toLowerCase().includes(V))};return T(async()=>{await p(h.getUsers())}),(r,e)=>(y(),U(W,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),items:n(d),loading:n(o),"item-value":"id","item-title":"username",label:"Search","custom-filter":i},{item:s(({props:t,item:V})=>[a(Q,H(t,{title:V.raw.username,subtitle:V.raw.email}),{prepend:s(()=>[a(B,null,{default:s(()=>[a(g,{src:`${n(u)}/api/v1/users/${V.value}/image`},{error:s(()=>[a(g,{src:n(P)},null,8,["src"])]),_:2},1032,["src"])]),_:2},1024)]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","items","loading"]))}}),ne=w({__name:"AddUser",setup(m){const l=c(!1),d=c(!1),o=L(),p=G(),u=c({username:"",email:"",password:""}),i=async()=>{var r,e;try{d.value=!0,await h.createUser(u.value),o.show("User created successfully!","success"),await p.fetch(),l.value=!1}catch(t){console.error(t),o.show(((e=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:e.message)||t.message)}finally{d.value=!1}};return(r,e)=>(y(),U(q,{modelValue:n(l),"onUpdate:modelValue":e[4]||(e[4]=t=>E(l)?l.value=t:null),"max-width":"600px",persistent:""},{activator:s(({props:t})=>[a(v,J(K(t)),{default:s(()=>e[5]||(e[5]=[f(" Create User ")])),_:2},1040)]),default:s(()=>[a(N,null,{default:s(()=>[a(F,null,{default:s(()=>[a(I,null,{default:s(()=>e[6]||(e[6]=[f("Create User")])),_:1})]),_:1}),a(k,null,{default:s(()=>[a(Z,null,{default:s(()=>[a(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).username,"onUpdate:modelValue":e[0]||(e[0]=t=>n(u).username=t),label:"Username",placeholder:"Enter username"},null,8,["modelValue"])]),_:1}),a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).email,"onUpdate:modelValue":e[1]||(e[1]=t=>n(u).email=t),label:"Email",placeholder:"Enter email"},null,8,["modelValue"])]),_:1}),a(_,{cols:"12"},{default:s(()=>[a(b,{modelValue:n(u).password,"onUpdate:modelValue":e[2]||(e[2]=t=>n(u).password=t),label:"Password",placeholder:"Enter password",type:"password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(z),a(X,{class:"pa-2"},{default:s(()=>[a(v,{color:"error",onClick:e[3]||(e[3]=t=>l.value=!1)},{default:s(()=>e[7]||(e[7]=[f(" Cancel ")])),_:1}),a(v,{color:"primary",variant:"elevated",onClick:i},{default:s(()=>e[8]||(e[8]=[f(" Create ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ae=w({__name:"UserListPage",setup(m){const l=c();return(d,o)=>(y(),U(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(N,null,{default:s(()=>[a(F,null,{default:s(()=>[a(I,null,{default:s(()=>o[1]||(o[1]=[f("User List")])),_:1})]),_:1}),a(k,null,{default:s(()=>[a(S,null,{default:s(()=>[a(_,{cols:"12"},{default:s(()=>[a(oe,{modelValue:n(l),"onUpdate:modelValue":o[0]||(o[0]=p=>E(l)?l.value=p:null)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(z),a(k,{class:"d-flex flex-wrap gap-4"},{default:s(()=>[a(ee),a(v,null,{default:s(()=>o[2]||(o[2]=[f("Search")])),_:1}),a(ne)]),_:1}),a(le)]),_:1})]),_:1})]),_:1}))}});export{Ae as default};
